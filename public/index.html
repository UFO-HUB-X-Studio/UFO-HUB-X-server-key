<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>UFO HUB X</title>

<!-- Google AdSense (Auto ads ‡∏Å‡πá‡∏û‡∏≠) -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1984718318642769" crossorigin="anonymous"></script>

<meta name="theme-color" content="#0a1411"/>
<meta name="color-scheme" content="dark"/>

<!-- preload ‡∏£‡∏π‡∏õ -->
<link rel="preload" as="image" href="https://i.postimg.cc/26L3yJ1g/file-00000000385861fab9ee0612cc0dca89.png">
<link rel="preload" as="image" href="https://i.postimg.cc/KcdBP7Fn/20250916-152130.png">
<link rel="preload" as="image" href="https://i.postimg.cc/hG6Pkr2s/Background-Eraser-20250916-190732755.png">

<style>
  :root{
    --ufo:#00ff99; --text:#d9fff5;
    --panel1:rgba(9,16,23,.88); --panel2:rgba(8,13,19,.92);
    --glow:rgba(34,255,200,.10);
    --hero-img:url("https://i.postimg.cc/KcdBP7Fn/20250916-152130.png");
    --ufo-ship:url("https://i.postimg.cc/hG6Pkr2s/Background-Eraser-20250916-190732755.png");
  }

  html,body{height:100%; background:#0a1411;}
  body{
    margin:0; min-height:100svh;
    font-family:"Orbitron",system-ui,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text);
    background:url("https://i.postimg.cc/26L3yJ1g/file-00000000385861fab9ee0612cc0dca89.png") center/cover fixed no-repeat;
  }

  .container{max-width:920px; margin:22px auto 92px; padding:0 18px;}

  /* HERO */
  .hero{display:flex; justify-content:center; margin:8px 0 20px;}
  .hero-box{
    display:inline-block; max-width:320px; width:90vw;
    border-radius:18px; overflow:hidden; position:relative;
    background:radial-gradient(1200px 400px at 50% -200px, rgba(0,255,160,.12), transparent 70%), #0b1a15;
    box-shadow:0 0 28px rgba(0,255,160,.18), 0 16px 44px rgba(0,0,0,.55);
  }
  .hero-img{display:block; width:100%; height:auto; object-fit:contain; background:var(--hero-img) center/contain no-repeat;}

  /* CARD */
  .card{
    background:linear-gradient(180deg,var(--panel1),var(--panel2));
    border-radius:18px;
    box-shadow:0 0 0 1px rgba(34,255,200,.06) inset, 0 10px 30px rgba(0,0,0,.55), 0 0 34px var(--glow);
    padding:18px; margin-bottom:22px; backdrop-filter: blur(2px);
    overflow:visible;
  }

  .head{display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap}
  .head-title{margin:0;font-size:40px;letter-spacing:.6px;text-shadow:0 0 12px rgba(0,255,170,.15)}
  .head-title .ufo{color:var(--ufo)}
  .head-title .hubx{color:#fff}

  .start-btn{
    appearance:none;border:0;cursor:pointer;padding:10px 18px;border-radius:14px;
    font-weight:800;background:var(--ufo);color:#072017;
    box-shadow:0 6px 18px rgba(0,255,140,.25),0 0 0 1px rgba(0,0,0,.25) inset;
    transition:filter .2s ease, opacity .2s ease, background .2s ease, color .2s ease;
  }
  .start-btn.ok   { background:#22c55e; color:#062512; }
  .start-btn.lock { background:#ff4d4d; color:#2b0505; cursor:not-allowed; opacity:.9; }

  /* Progress */
  .progress-meta{display:flex;align-items:center;justify-content:space-between;margin-top:10px;margin-bottom:6px;font-weight:800;font-size:14px;color:#cffff2;text-shadow:0 0 6px rgba(0,0,0,.75);position:relative;z-index:2;}
  .bar-wrap{position:relative;width:100%;height:18px;border-radius:10px;overflow:visible;background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.35));box-shadow:inset 0 0 0 1px rgba(34,255,200,.10)}
  .bar{position:absolute;left:0;top:0;bottom:0;width:0%;background:linear-gradient(90deg,#00ffa3,#3bffbf);box-shadow:0 0 18px rgba(34,255,200,.35);z-index:1;}
  .bar-ufo{position:absolute; top:50%; transform:translate(-50%,-50%); width:50px;height:50px; opacity:0; transition:opacity .2s ease; background:var(--ufo-ship) center/contain no-repeat; filter:drop-shadow(0 0 2px #fff) drop-shadow(0 0 14px rgba(0,255,160,.9)) drop-shadow(0 0 24px rgba(0,255,160,.7)); z-index:8; pointer-events:none;}
  .bar-ufo.on{opacity:1;}

  .key-head{display:flex;justify-content:space-between;align-items:center;margin:10px 0}
  .key-title{font-size:18px;color:#ffea63;display:flex;align-items:center;gap:8px}
  .new-btn{appearance:none;border:0;cursor:pointer;font-weight:800;padding:10px 14px;border-radius:12px;background:var(--ufo);color:#071a14;box-shadow:0 6px 18px rgba(0,255,140,.25),0 0 0 1px rgba(0,0,0,.25) inset}
  .new-btn[disabled]{opacity:.6; cursor:not-allowed;}
  table{width:100%;border-collapse:collapse;color:var(--text);font-size:14px}
  th,td{padding:10px 8px;text-align:center}
  th{color:#77ffc8;font-weight:600}
  td .pill{display:inline-block;padding:6px 12px;border-radius:999px;background:rgba(0,255,160,.12);border:1px solid rgba(0,255,160,.35);font-weight:800;color:#6bffc8}
  .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
  .btn-ghost{background:rgba(255,255,255,.06);color:#e7fff7;border:1px solid rgba(255,255,255,.18)}
  .btn-green{background:var(--ufo);color:#05261a}
  .actions{display:flex;gap:10px;justify-content:center}

  @media (max-width:560px){
    .head-title{font-size:34px}
    .bar-ufo{width:46px;height:46px}
  }

  /* Splash */
  .splash{position:fixed; inset:0; background:rgba(0,0,0,.78); display:none; align-items:center; justify-content:center; z-index:9999; backdrop-filter: blur(2px);}
  .splash.show{display:flex;}
  .splash-card{width:240px; border-radius:22px; padding:16px 16px 22px; background:linear-gradient(180deg, rgba(8,13,19,.96), rgba(9,16,23,.96)); box-shadow:0 0 0 1px rgba(34,255,200,.12) inset, 0 12px 40px rgba(0,0,0,.6), 0 0 34px var(--glow); display:flex; flex-direction:column; align-items:center; gap:12px; position:relative;}
  .splash-avatar{width:68px; height:68px; border-radius:50%; background:url('https://i.postimg.cc/KcdBP7Fn/20250916-152130.png') center/cover no-repeat; box-shadow:0 0 0 2px rgba(255,255,255,.1), 0 0 18px rgba(0,255,160,.3);}
  .splash-title{display:flex; flex-direction:column; align-items:center; line-height:1.15; font-weight:900; text-shadow:0 0 12px rgba(0,255,170,.25);}
  .splash-title .main{ font-size:22px; font-weight:900; letter-spacing:.8px; }
  .splash-title .ufo{ color:var(--ufo); }
  .splash-title .hubx{ color:#fff; }
  .splash-title .download{ font-size:16px; font-weight:700; color:#d9fff5; margin-top:4px; letter-spacing:.6px; }
  .splash-meter{ position:relative; width:150px; height:150px; }
  .splash-svg{ position:absolute; inset:0; width:100%; height:100%; transform:rotate(-90deg); }
  .splash-circle-bg{stroke:rgba(255,255,255,.12); stroke-width:10; fill:none;}
  .splash-circle{stroke:var(--ufo); stroke-width:10; fill:none; filter:drop-shadow(0 0 10px rgba(0,255,170,.6)); stroke-linecap:round;}
  .splash-num{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:28px; letter-spacing:1px; color:var(--text); pointer-events:none;}
</style>
</head>
<body>
  <!-- Splash -->
  <div class="splash" id="splash">
    <div class="splash-card">
      <div class="splash-avatar" aria-hidden="true"></div>
      <div class="splash-title">
        <div class="main"><span class="ufo">UFO</span> <span class="hubx">HUB X</span></div>
        <div class="download">Download</div>
      </div>
      <div class="splash-meter">
        <svg class="splash-svg" viewBox="0 0 200 200" aria-hidden="true">
          <circle class="splash-circle-bg" cx="100" cy="100" r="65"></circle>
          <circle class="splash-circle" id="splashCircle" cx="100" cy="100" r="65" stroke-dasharray="0 999"></circle>
        </svg>
        <div class="splash-num" id="splashNum">0%</div>
      </div>
    </div>
  </div>

  <div class="container">

    <!-- HERO -->
    <div class="hero">
      <div class="hero-box">
        <img class="hero-img" src="https://i.postimg.cc/KcdBP7Fn/20250916-152130.png" alt="UFO HUB X">
      </div>
    </div>

    <!-- Title + Button + Progress -->
    <section class="card">
      <div class="head">
        <h1 class="head-title"><span class="ufo">UFO</span> <span class="hubx">HUB X</span></h1>
        <button class="start-btn" id="startBtn">üü¢ START</button>
      </div>

      <div class="progress-meta">
        <div id="progressText">Progress: 0/1</div>
        <div id="percentText">0%</div>
      </div>

      <div class="bar-wrap" id="barWrap">
        <div class="bar" id="bar"></div>
        <div class="bar-ufo" id="barUfo" style="left:0px"></div>
      </div>
      <div class="note" id="hintLine" style="margin-top:8px;color:#cfeee6;font-size:13px;"></div>
    </section>

    <!-- Your Key -->
    <section class="card">
      <div class="key-head">
        <div class="key-title">üîë Your Key</div>
        <button class="new-btn" id="getKey">+ GET A NEW KEY</button>
      </div>
      <table>
        <thead>
          <tr><th>KEY</th><th>TIME LEFT</th><th>STATUS</th><th>ACTIONS</th></tr>
        </thead>
        <tbody id="keyRows"></tbody>
      </table>
      <div class="note">
        ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏∞‡πÄ‡∏ä‡πá‡∏Å <code>/status</code> ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‚Äî ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡∏ö
      </div>
    </section>

  </div>

<script>
/* ========= CONFIG ========= */
const START_URL       = "https://direct-link.net/1398143/IGoZdaaTcIHW"; // ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
const MIN_VISIT       = 5000;   // ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 5 ‡∏ß‡∏¥
const UFO_MS          = 4000;   // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô progress
const RETURN_MARK     = "ufo_return_ts";
const PENDING_ACTION  = "ufo_pending_action"; // 'start' | 'extend'

/* ========= Elements ========= */
const bar       = document.getElementById('bar');
const barWrap   = document.getElementById('barWrap');
const barUfo    = document.getElementById('barUfo');
const pText     = document.getElementById('progressText');
const percentEl = document.getElementById('percentText');
const startBtn  = document.getElementById('startBtn');
const getKeyBtn = document.getElementById('getKey');
const keyRows   = document.getElementById('keyRows');
const hintLine  = document.getElementById('hintLine');

/* Splash */
const splash       = document.getElementById('splash');
const splashCircle = document.getElementById('splashCircle');
const splashNum    = document.getElementById('splashNum');
const SPLASH_MS    = 10000;
const SPLASH_FLAG  = "ufo_splash_shown";
const SPLASH_SKIP  = "ufo_skip_splash_once";
const SPLASH_SKIP_LS = "ufo_skip_splash_once_ls";

let isCompleted = false;
let raf = null;
let leftTimer = null;

/* ========= URL / ORIGIN ========= */
const url   = new URL(location.href);
const uid   = url.searchParams.get('uid')   || '';
const place = url.searchParams.get('place') || '';
const ORIGIN = location.origin.replace(/\/+$/,'');

/* ========= utils ========= */
function runProgress(pTarget=100, duration=UFO_MS){
  cancelAnimationFrame(raf);
  barUfo.classList.add('on');
  const pStart=parseFloat(bar.style.width)||0, t0=performance.now();
  function setProgress(p){
    if (p<0)p=0; if(p>100)p=100;
    bar.style.width = p+'%';
    const barRect=bar.getBoundingClientRect(), wrapRect=barWrap.getBoundingClientRect();
    const tipInside = (barRect.left+barRect.width)-wrapRect.left;
    barUfo.style.left = (tipInside + 8) + 'px';
    percentEl.textContent = p.toFixed(0)+'%';
    pText.textContent = 'Progress: ' + (p>=100 ? '1/1':'0/1');
    if (p>=100 && !isCompleted){
      isCompleted = true;
      startBtn.classList.add('ok');
      startBtn.disabled = true;
      startBtn.textContent = '‚úÖ';
    }
  }
  function tick(ts){ const t=Math.min(1,(ts-t0)/duration); setProgress(pStart+(pTarget-pStart)*t); if(t<1){ raf=requestAnimationFrame(tick);} }
  raf=requestAnimationFrame(tick);
}
function hmsFromUnix(exp){
  const ms = Math.max(0, exp*1000 - Date.now());
  const s = Math.floor(ms/1000);
  const h = Math.floor(s/3600);
  const m = Math.floor((s%3600)/60);
  const ss = s%60;
  return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;
}
function shouldShowSplash(){
  if (sessionStorage.getItem(SPLASH_SKIP) === '1'){ sessionStorage.removeItem(SPLASH_SKIP); return false; }
  if (localStorage.getItem(SPLASH_SKIP_LS) === '1'){ localStorage.removeItem(SPLASH_SKIP_LS); return false; }
  if (sessionStorage.getItem(SPLASH_FLAG) === '1') return false;
  return true;
}
function showSplash(){
  splash.classList.add('show');
  const R = 65, C = 2*Math.PI*R;
  splashCircle.setAttribute('stroke-dasharray', `0 ${C}`);
  splashNum.textContent = '0%';
  const t0 = performance.now();
  function tick(ts){
    const t = Math.min(1, (ts - t0)/SPLASH_MS);
    const pct = Math.round(t*100);
    splashNum.textContent = pct + '%';
    const dash = C * t;
    splashCircle.setAttribute('stroke-dasharray', `${dash} ${C}`);
    if (t < 1) requestAnimationFrame(tick); else hideSplash();
  }
  requestAnimationFrame(tick);
}
function hideSplash(){
  splash.classList.remove('show');
  sessionStorage.setItem(SPLASH_FLAG,'1');
}

/* ========= API helpers ========= */
async function api(path){
  const res = await fetch(`${ORIGIN}${path}`, {cache:'no-store'});
  return res.json().catch(()=>({ok:false}));
}
const apiStatus = () => api(`/status?uid=${encodeURIComponent(uid)}&place=${encodeURIComponent(place)}`);
const apiGetKey = () => api(`/getkey?uid=${encodeURIComponent(uid)}&place=${encodeURIComponent(place)}`);
const apiExtend = () => api(`/extend?uid=${encodeURIComponent(uid)}&place=${encodeURIComponent(place)}`);

/* ========= UI: render key ========= */
function clearTimer(){ if(leftTimer) { clearInterval(leftTimer); leftTimer=null; } }

function renderKeyNone(msg){
  clearTimer();
  keyRows.innerHTML='';
  const tr=document.createElement('tr');
  const td=document.createElement('td');
  td.colSpan=4; td.textContent = msg || '(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå ‚Äî ‡πÉ‡∏´‡πâ‡∏Å‡∏î START ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏î + GET A NEW KEY)';
  tr.appendChild(td);
  keyRows.appendChild(tr);
  getKeyBtn.disabled = false;
  getKeyBtn.textContent = '+ GET A NEW KEY';
}

function renderKeyRow(data){
  clearTimer();
  keyRows.innerHTML='';

  if(!data || !data.key){
    renderKeyNone();
    return;
  }

  const tr=document.createElement('tr');
  const tdKey=document.createElement('td');
  const tdLeft=document.createElement('td');
  const tdStat=document.createElement('td');
  const tdAct=document.createElement('td');

  tdKey.style.fontWeight='900'; tdKey.style.letterSpacing='1px';
  tdKey.textContent=data.key;

  const expired = data.expires_at ? (Date.now()/1000 >= data.expires_at) : false;
  tdStat.innerHTML = expired ? '<span class="pill" style="border-color:#ff9d9d;color:#ffcaca;background:rgba(255,0,0,.12)">EXPIRED</span>' : '<span class="pill">ACTIVE</span>';
  tdLeft.textContent = data.expires_at ? hmsFromUnix(data.expires_at) : '-';

  const acts=document.createElement('div'); acts.className='actions';
  const btnCopy=document.createElement('button'); btnCopy.className='btn btn-ghost'; btnCopy.innerHTML='üìã Copy';
  btnCopy.addEventListener('click', async ()=>{
    try{ await navigator.clipboard.writeText(data.key); btnCopy.textContent='‚úÖ Copied'; setTimeout(()=>btnCopy.innerHTML='üìã Copy',1200);}catch(e){ alert('Copy failed'); }
  });
  acts.appendChild(btnCopy);

  const btnPlus=document.createElement('button'); btnPlus.className='btn btn-green'; btnPlus.innerHTML='‚è© +5H';
  btnPlus.disabled = expired; // ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≠
  btnPlus.addEventListener('click', ()=>{
    // ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å /extend
    try{
      sessionStorage.setItem(RETURN_MARK, String(Date.now()));
      sessionStorage.setItem(PENDING_ACTION, 'extend');
      sessionStorage.setItem(SPLASH_SKIP,'1');
      localStorage.setItem(SPLASH_SKIP_LS,'1');
    }catch(e){}
    location.href = START_URL;
  });
  acts.appendChild(btnPlus);

  tdAct.appendChild(acts);
  tr.appendChild(tdKey); tr.appendChild(tdLeft); tr.appendChild(tdStat); tr.appendChild(tdAct);
  keyRows.appendChild(tr);

  // countdown
  if(data.expires_at && !expired){
    leftTimer = setInterval(()=>{
      const exp = data.expires_at;
      const nowS = Math.floor(Date.now()/1000);
      if(nowS >= exp){
        clearTimer();
        tdLeft.textContent = '00:00:00';
        tdStat.innerHTML = '<span class="pill" style="border-color:#ff9d9d;color:#ffcaca;background:rgba(255,0,0,.12)">EXPIRED</span>';
        getKeyBtn.disabled = false;
        getKeyBtn.textContent = '+ GET A NEW KEY';
      }else{
        tdLeft.textContent = hmsFromUnix(exp);
      }
    }, 1000);
  }

  // ‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏° GET
  if(!expired){
    getKeyBtn.disabled = true;
    getKeyBtn.textContent = 'üîí WAIT';
  }else{
    getKeyBtn.disabled = false;
    getKeyBtn.textContent = '+ GET A NEW KEY';
  }
}

/* ========= Return handling ========= */
function validReturn(){
  const t = Number(sessionStorage.getItem(RETURN_MARK)||'0');
  return t && (Date.now() - t) >= MIN_VISIT;
}

async function handleReturnFlow(){
  const act = sessionStorage.getItem(PENDING_ACTION)||'';
  if(!act) return;

  if(!validReturn()){
    // ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
    sessionStorage.removeItem(PENDING_ACTION);
    return;
  }
  sessionStorage.removeItem(RETURN_MARK);

  if(act === 'extend'){
    // ‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
    let ex = await apiExtend();
    if(!(ex && ex.ok)){
      alert('‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚è© +5H');
    }
  }
  sessionStorage.removeItem(PENDING_ACTION);
}

/* ========= INIT ========= */
async function init(){
  // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ uid ‡πÅ‡∏•‡∏∞ place ‡πÉ‡∏ô URL ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  if(!uid || !place){
    renderKeyNone('‚ö†Ô∏è URL ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ uid/place ‚Äî ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Get Key ‡πÉ‡∏ô Roblox ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
    startBtn.disabled = true; startBtn.classList.add('lock'); startBtn.textContent = '‚õî NO UID/PLACE';
    hintLine.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ uid ‡πÅ‡∏•‡∏∞ place';
    return;
  }

  // Splash ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  if (shouldShowSplash()) showSplash();
  runProgress();

  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏ô‡∏≤‡∏ô‡∏û‡∏≠ ‚Üí ‡∏ó‡∏≥ action ‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ (‡πÄ‡∏ä‡πà‡∏ô extend)
  await handleReturnFlow();

  // ‡πÄ‡∏ä‡πá‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏™‡∏°‡∏≠
  let st = await apiStatus().catch(()=>({ok:false}));
  if(st && st.ok && st.expires_at && !st.expired && (st.remaining===undefined || st.remaining>0)){
    renderKeyRow(st);
    hintLine.textContent = '‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå';
  }else{
    renderKeyNone();
    hintLine.textContent = '‚ÑπÔ∏è ‡∏Å‡∏î START ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 5 ‡∏ß‡∏¥ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î + GET A NEW KEY';
  }
}

/* ========= Events ========= */
// START: ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
startBtn.addEventListener('click', ()=>{
  if(startBtn.disabled) return;
  try{
    sessionStorage.setItem(RETURN_MARK, String(Date.now()));
    sessionStorage.setItem(PENDING_ACTION, 'start');
    sessionStorage.setItem(SPLASH_SKIP,'1');
    localStorage.setItem(SPLASH_SKIP_LS,'1');
  }catch(e){}
  location.href = START_URL;
});

// GET KEY: ‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà ‚Äú‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‚Äù
getKeyBtn.addEventListener('click', async ()=>{
  if(getKeyBtn.disabled) return;

  // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡πÅ‡∏•‡πâ‡∏ß (‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
  let st = await apiStatus().catch(()=>({ok:false}));
  if(st && st.ok && st.expires_at && !st.expired && (st.remaining===undefined || st.remaining>0)){
    renderKeyRow(st);
    hintLine.textContent = '‚úÖ ‡∏û‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏î‡∏¥‡∏° ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢';
    return;
  }

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏à‡∏≤‡∏Å START ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ñ‡∏£‡∏ö‡∏¢‡∏±‡∏á
  if(!validReturn()){
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î START ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏î + GET A NEW KEY');
    return;
  }

  // ‡∏Ç‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
  getKeyBtn.disabled = true; getKeyBtn.textContent = '‚è≥ Requesting...';
  let gk = await apiGetKey().catch(()=>({ok:false}));
  if(!(gk && gk.ok)){
    getKeyBtn.disabled=false; getKeyBtn.textContent='+ GET A NEW KEY';
    alert('‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
    return;
  }

  // ‡∏¢‡πâ‡∏≥‡∏î‡πâ‡∏ß‡∏¢ /status ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏µ‡∏¢‡πå ‚Äú‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‚Äù ‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
  st = await apiStatus().catch(()=>null);
  const show = (st && st.ok) ? st : gk;
  renderKeyRow(show);
  hintLine.textContent = gk.reused ? '‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏î‡∏¥‡∏°' : '‚úÖ ‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
});

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
init();
</script>
</body>
</html>
