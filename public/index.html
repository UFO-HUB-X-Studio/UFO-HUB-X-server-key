<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UFO HUB X ‚Äî Get Key</title>
  <style>
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:#0b0f13 url("https://cdn.discordapp.com/attachments/1417098355388973154/1417560780110434446/file_00000000385861fab9ee0612cc0dca89.png") center/cover fixed no-repeat;
      color:#e7f4ee; margin:0; padding:30px; text-align:center;
    }
    .card{max-width:760px;margin:0 auto;background:#10161dcc;padding:24px;border-radius:16px;box-shadow:0 0 20px #0009;}
    .logo{width:200px;margin-bottom:20px;}
    h1{color:#00ff8c;margin-bottom:8px;}
    .btn{
      display:inline-flex;align-items:center;gap:10px;
      margin:16px auto;padding:14px 20px;font-size:17px;font-weight:800;
      color:#08120e;background:#00ff8c;border:none;border-radius:12px;
      cursor:pointer;transition:.15s;
    }
    .btn:disabled{opacity:.6;cursor:not-allowed;}
    .btn.ghost{background:#0f151a;color:#e7f4ee;border:1px solid rgba(0,255,140,.28)}
    table{width:100%;margin-top:20px;border-collapse:collapse}
    th,td{padding:12px;border-bottom:1px solid #2a2f34;text-align:left}
    th{color:#9cc6b5}
    .pill{padding:6px 12px;border-radius:999px;font-weight:800;font-size:13px}
    .active{background:#0e1a14;color:#00ff8c}
    .expired{background:#2a1114;color:#ff4d4d}
    .row-actions{display:flex;gap:10px;align-items:center}
    .mini{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:10px;border:1px solid rgba(0,255,140,.28);
      background:#00ff8c;color:#08120e;font-weight:700;cursor:pointer;
    }
    .mini.ghost{background:#0f151a;color:#e7f4ee}
    .icon{
      width:16px;height:16px;display:inline-block;
    }
  </style>
</head>
<body>
  <div class="card">
    <img class="logo" src="https://cdn.discordapp.com/attachments/1417098355388973154/1417560447279960194/20250916_152130.png" alt="UFO HUB X">
    <h1>UFO HUB X</h1>

    <button id="getKeyBtn" class="btn">Ôºã GET A NEW KEY</button>

    <table>
      <thead>
        <tr><th>KEY</th><th>TIME LEFT</th><th>STATUS</th><th>ACTIONS</th></tr>
      </thead>
      <tbody id="keyRows"></tbody>
    </table>
  </div>

<script>
/* ---------- State & storage ---------- */
const $ = s=>document.querySelector(s);
const STORAGE_KEYS = "ufo_keys";
let keys = JSON.parse(localStorage.getItem(STORAGE_KEYS) || "[]"); // ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

function saveKeys(){ localStorage.setItem(STORAGE_KEYS, JSON.stringify(keys)); }

/* ---------- Helpers ---------- */
function fmtLeft(ms){
  if(ms<=0) return "Expired";
  const h=String(Math.floor(ms/3600000)).padStart(2,"0");
  const m=String(Math.floor((ms%3600000)/60000)).padStart(2,"0");
  const s=String(Math.floor((ms%60000)/1000)).padStart(2,"0");
  return `${h}:${m}:${s}`;
}
function setClaimButtonState(){
  const btn = $("#getKeyBtn");
  if(keys.length===0){
    btn.disabled = false;
    btn.textContent = "Ôºã GET A NEW KEY";
  }else{
    // ‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°; ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°
    const k = keys[0];
    const left = k.expires - Date.now();
    if(left > 0){
      btn.disabled = true;
      btn.textContent = "‚úÖ Already claimed";
    }else{
      btn.disabled = false;
      btn.textContent = "Ôºã GET A NEW KEY";
    }
  }
}

/* ---------- Render ---------- */
function paint(){
  const body = $("#keyRows");
  body.innerHTML = "";

  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å
  if(keys.length>1){ keys = [keys[0]]; saveKeys(); }

  if(keys.length===0){ setClaimButtonState(); return; }

  const k = keys[0];
  const left = k.expires - Date.now();

  // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí ‡∏•‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå & ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ
  if(left <= 0){
    keys = [];
    saveKeys();
    setClaimButtonState();
    return;
  }

  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td style="font-weight:800">${k.value}</td>
    <td>${fmtLeft(left)}</td>
    <td><span class="pill ${left>0?'active':'expired'}">${left>0?'ACTIVE':'EXPIRED'}</span></td>
    <td>
      <div class="row-actions">
        <button class="mini ghost" id="copyBtn">üìã Copy</button>
        <button class="mini" id="plusBtn">
          <!-- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô SVG ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
          <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M5 12h9m0 0l-3-3m3 3l-3 3M16 7h3a2 2 0 012 2v6a2 2 0 01-2 2h-3"/>
          </svg>
          +5H
        </button>
      </div>
    </td>
  `;
  body.appendChild(tr);

  // actions
  $("#copyBtn").onclick = async () => {
    await navigator.clipboard.writeText(k.value);
    const old = $("#copyBtn").textContent;
    $("#copyBtn").textContent = "‚úì Copied";
    setTimeout(()=> $("#copyBtn").textContent = old, 900);
  };

  // ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå + ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
  $("#plusBtn").onclick = () => {
    // ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà
    window.open("https://direct-link.net/1398143/IGoZdaaTcIHW", "_blank");
    // ‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤ +5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏µ‡∏¢‡πå
    k.expires += 5*60*60*1000;
    saveKeys();
    paint();
  };

  setClaimButtonState();
}

/* ---------- Claim new key ---------- */
async function claimKey(){
  // ‡∏Ç‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡∏à‡∏≤‡∏Å API ‡∏à‡∏£‡∏¥‡∏á
  try{
    const res = await fetch("/api/getkey", { method:"POST" });
    const data = await res.json();
    if(!data?.ok) throw new Error("Cannot get key");
    keys = [{ value: data.key, expires: data.expiresAt }];
    saveKeys();
    setClaimButtonState();
    paint();
    // ‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå‡∏à‡∏∞‡∏û‡∏≤‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå (‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤)
    window.location.href = "https://direct-link.net/1398143/IGoZdaaTcIHW";
  }catch(e){
    alert("‡∏Ç‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    console.error(e);
  }
}
$("#getKeyBtn").addEventListener("click", claimKey);

/* ---------- Tick & init ---------- */
paint();
setInterval(paint, 1000);
</script>
</body>
</html>
