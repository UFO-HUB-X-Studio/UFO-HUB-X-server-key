<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>UFO HUB X</title>

<!-- (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ AdSense ‡∏Ñ‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ) -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1984718318642769" crossorigin="anonymous"></script>

<meta name="theme-color" content="#0a1411"/>
<meta name="color-scheme" content="dark"/>

<style>
  :root{
    --ufo:#00ff99; --text:#d9fff5;
    --panel1:rgba(9,16,23,.88); --panel2:rgba(8,13,19,.92);
    --glow:rgba(34,255,200,.10);
  }
  html,body{height:100%; background:#0a1411;}
  body{
    margin:0; min-height:100svh;
    font-family:system-ui, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:#07110e url("https://i.postimg.cc/26L3yJ1g/file-00000000385861fab9ee0612cc0dca89.png") center/cover fixed no-repeat;
  }
  .container{max-width:920px; margin:22px auto 92px; padding:0 18px;}

  .card{
    background:linear-gradient(180deg,var(--panel1),var(--panel2));
    border-radius:18px;
    box-shadow:0 0 0 1px rgba(34,255,200,.06) inset, 0 10px 30px rgba(0,0,0,.55), 0 0 34px var(--glow);
    padding:18px; margin-bottom:22px; backdrop-filter: blur(2px);
  }

  .head{display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap}
  .head-title{margin:0;font-size:40px;letter-spacing:.6px;text-shadow:0 0 12px rgba(0,255,170,.15)}
  .head-title .ufo{color:var(--ufo)}
  .head-title .hubx{color:#fff}

  .start-btn{
    appearance:none;border:0;cursor:pointer;padding:10px 18px;border-radius:14px;
    font-weight:800;background:var(--ufo);color:#072017;
    box-shadow:0 6px 18px rgba(0,255,140,.25),0 0 0 1px rgba(0,0,0,.25) inset;
    transition:.2s;
  }
  .start-btn.lock { background:#ff4d4d; color:#2b0505; cursor:not-allowed; opacity:.9; }

  .progress-meta{display:flex;align-items:center;justify-content:space-between;margin-top:10px;margin-bottom:6px;font-weight:800;font-size:14px;color:#cffff2;text-shadow:0 0 6px rgba(0,0,0,.75)}
  .bar-wrap{position:relative;width:100%;height:18px;border-radius:10px;overflow:hidden;background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.35));box-shadow:inset 0 0 0 1px rgba(34,255,200,.10)}
  .bar{position:absolute;left:0;top:0;bottom:0;width:0%;background:linear-gradient(90deg,#00ffa3,#3bffbf);box-shadow:0 0 18px rgba(34,255,200,.35)}

  .key-head{display:flex;justify-content:space-between;align-items:center;margin:10px 0}
  .key-title{font-size:18px;color:#ffea63;display:flex;align-items:center;gap:8px}
  .new-btn{appearance:none;border:0;cursor:pointer;font-weight:800;padding:10px 14px;border-radius:12px;background:var(--ufo);color:#071a14;box-shadow:0 6px 18px rgba(0,255,140,.25),0 0 0 1px rgba(0,0,0,.25) inset}
  .new-btn[disabled]{opacity:.6; cursor:not-allowed;}
  table{width:100%;border-collapse:collapse;color:var(--text);font-size:14px}
  th,td{padding:10px 8px;text-align:center}
  th{color:#77ffc8;font-weight:600}
  td .pill{display:inline-block;padding:6px 12px;border-radius:999px;background:rgba(0,255,160,.12);border:1px solid rgba(0,255,160,.35);font-weight:800;color:#6bffc8}
  .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
  .btn-ghost{background:rgba(255,255,255,.06);color:#e7fff7;border:1px solid rgba(255,255,255,.18)}
  .btn-green{background:var(--ufo);color:#05261a}
  .actions{display:flex;gap:10px;justify-content:center}
</style>
</head>
<body>
  <div class="container">
    <!-- Title + Button + Progress -->
    <section class="card">
      <div class="head">
        <h1 class="head-title"><span class="ufo">UFO</span> <span class="hubx">HUB X</span></h1>
        <button class="start-btn" id="startBtn">üü¢ START</button>
      </div>

      <div class="progress-meta">
        <div id="progressText">Progress: 0/1</div>
        <div id="percentText">0%</div>
      </div>

      <div class="bar-wrap" id="barWrap">
        <div class="bar" id="bar"></div>
      </div>
    </section>

    <!-- Your Key -->
    <section class="card">
      <div class="key-head">
        <div class="key-title">üîë Your Key</div>
        <button class="new-btn" id="getKey">+ GET A NEW KEY</button>
      </div>
      <table>
        <thead>
          <tr><th>KEY</th><th>TIME LEFT</th><th>STATUS</th><th>ACTIONS</th></tr>
        </thead>
        <tbody id="keyRows"></tbody>
      </table>
    </section>
  </div>

<script>
/* ===================== CONFIG ===================== */
const API_BASE     = location.origin;         // ‡∏™‡∏°‡∏°‡∏ï‡∏¥ web ‡∏Å‡∏±‡∏ö API ‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
const START_URL    = "https://direct-link.net/1398143/IGoZdaaTcIHW"; // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å monetize ‡∏ï‡∏≠‡∏ô START
const BASE_HOURS   = 48;
const EXTEND_HOURS = 5;
const UFO_MS       = 4000; // progress 4s

/* ===================== Elements ===================== */
const bar       = document.getElementById('bar');
const pText     = document.getElementById('progressText');
const percentEl = document.getElementById('percentText');
const startBtn  = document.getElementById('startBtn');
const getKeyBtn = document.getElementById('getKey');
const keyRows   = document.getElementById('keyRows');

/* ===================== Utils ===================== */
const now = ()=>Date.now();
const hms = (ms)=>{ if(ms<0)ms=0; const s=Math.floor(ms/1000);const h=Math.floor(s/3600),m=Math.floor((s%3600)/60),ss=s%60; return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`; };
const qs = new URLSearchParams(location.search);
const QUID   = qs.get("uid")   || "";
const QPLACE = qs.get("place") || "";

/* localStorage store (‡πÄ‡∏Å‡πá‡∏ö‡∏ù‡∏±‡πà‡∏á client ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á) */
const KEY_STORE = "ufo_key_store_v1";
function getStore(){ try{ return JSON.parse(localStorage.getItem(KEY_STORE)||'{}'); }catch(e){ return {}; } }
function setStore(o){ try{ localStorage.setItem(KEY_STORE, JSON.stringify(o)); }catch(e){} }
function idPair(){ return QUID + "::" + QPLACE; }
function getMyKey(){ return getStore()[idPair()] || null; }
function setMyKey(d){ const s=getStore(); s[idPair()]=d; setStore(s); }
function clearMyKey(){ const s=getStore(); delete s[idPair()]; setStore(s); }

async function jget(path){
  const res = await fetch(API_BASE + path, {cache:"no-store"});
  if(!res.ok) throw new Error("http");
  return await res.json();
}

/* ===================== Progress Bar ===================== */
let raf=null, isCompleted=false;
function setProgress(p){
  if (p<0)p=0; if(p>100)p=100;
  bar.style.width = p+'%';
  percentEl.textContent = p.toFixed(0)+'%';
  pText.textContent = 'Progress: ' + (p>=100 ? '1/1':'0/1');
  if (p>=100 && !isCompleted){
    isCompleted = true;
    startBtn.disabled = true;
    startBtn.textContent = '‚úÖ';
    updateGetKeyButtonState();
  }
}
function runProgress(duration=UFO_MS){
  cancelAnimationFrame(raf);
  const t0=performance.now();
  function tick(ts){
    const t=Math.min(1,(ts-t0)/duration);
    setProgress(100*t);
    if(t<1) raf=requestAnimationFrame(tick);
  }
  raf=requestAnimationFrame(tick);
}

/* ===================== Key UI ===================== */
let keyTimer=null;
function renderKeyRow(data){
  keyRows.innerHTML='';
  const tr=document.createElement('tr');
  const tdKey=document.createElement('td');
  const tdLeft=document.createElement('td');
  const tdStat=document.createElement('td');
  const tdAct=document.createElement('td');

  tdKey.style.fontWeight='900'; tdKey.style.letterSpacing='1px';
  tdKey.textContent = data.key || '(no key)';
  tdStat.innerHTML  = '<span class="pill">ACTIVE</span>';

  const actions=document.createElement('div'); actions.className='actions';
  const btnCopy=document.createElement('button'); btnCopy.className='btn btn-ghost'; btnCopy.innerHTML='üìã Copy';
  const btnAdd5=document.createElement('button'); btnAdd5.className='btn btn-green'; btnAdd5.innerHTML='‚è© +5H';
  actions.appendChild(btnCopy); actions.appendChild(btnAdd5); tdAct.appendChild(actions);

  function tickLeft(){
    const left=data.until - now();
    tdLeft.textContent = left>0 ? hms(left) : '00:00:00';
    if(left<=0){
      clearInterval(keyTimer);
      clearMyKey();
      updateGetKeyButtonState();
    }
  }
  tickLeft();
  if(keyTimer) clearInterval(keyTimer);
  keyTimer=setInterval(tickLeft,1000);

  btnCopy.addEventListener('click', async ()=>{
    try{ await navigator.clipboard.writeText(String(data.key||"")); btnCopy.textContent='‚úÖ Copied'; setTimeout(()=>btnCopy.innerHTML='üìã Copy',1200);}catch(e){ alert('Copy failed'); }
  });

  // ‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏ú‡πà‡∏≤‡∏ô API /extend (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)
  btnAdd5.addEventListener('click', async ()=>{
    try{
      btnAdd5.disabled = true;
      await jget(`/extend?uid=${encodeURIComponent(QUID)}&place=${encodeURIComponent(QPLACE)}`);
      await refreshFromStatus(); // ‡∏î‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å server
    }catch(e){
      alert('Extend failed');
    }finally{
      btnAdd5.disabled = false;
    }
  });

  tr.appendChild(tdKey); tr.appendChild(tdLeft); tr.appendChild(tdStat); tr.appendChild(tdAct);
  keyRows.prepend(tr);
}

/* ‡∏î‡∏∂‡∏á/‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≤‡∏Å /status */
async function refreshFromStatus(){
  if(!QUID || !QPLACE) return;
  const data = await jget(`/status?uid=${encodeURIComponent(QUID)}&place=${encodeURIComponent(QPLACE)}`);
  if(data && data.ok && data.expires_at){
    const untilMs = Number(data.expires_at)*1000;
    const payload = { key: String(data.key||""), until: untilMs };
    setMyKey(payload);
    renderKeyRow(payload);
    updateGetKeyButtonState();
  }
}

/* ‡∏õ‡∏∏‡πà‡∏° GET KEY: ‡∏Ç‡∏≠‡∏à‡∏≤‡∏Å /getkey ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏ï‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏Å config) */
function wireGetKeyButton(){
  if(!getKeyBtn) return;
  getKeyBtn.disabled = (!QUID || !QPLACE);
  getKeyBtn.textContent = getKeyBtn.disabled ? 'üîí START first' : '+ GET A NEW KEY';

  getKeyBtn.addEventListener('click', async ()=>{
    if(getKeyBtn.disabled) return;
    try{
      getKeyBtn.disabled = true;
      getKeyBtn.textContent = '‚è≥ WAIT...';
      await jget(`/getkey?uid=${encodeURIComponent(QUID)}&place=${encodeURIComponent(QPLACE)}`);
      await refreshFromStatus();
    }catch(e){
      alert('‡∏Ç‡∏≠‡∏Ñ‡∏µ‡∏¢‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }finally{
      updateGetKeyButtonState();
    }
  });
}

function updateGetKeyButtonState(){
  const mine = getMyKey();
  const active = !!(mine && now()<mine.until);
  if (!QUID || !QPLACE){
    getKeyBtn.disabled = true;
    getKeyBtn.textContent = 'üîí START first';
  }else{
    getKeyBtn.disabled = active;
    getKeyBtn.textContent = active ? 'üîí WAIT' : '+ GET A NEW KEY';
  }
}

/* START (‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏≥ progress/monetize ‡πÄ‡∏â‡∏¢‡πÜ) */
startBtn.addEventListener('click', ()=>{
  if(startBtn.disabled) return;
  runProgress(UFO_MS);
  // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏û‡∏≤‡∏Ñ‡∏ô‡∏≠‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå ‡πÉ‡∏´‡πâ uncomment ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
  // window.open(START_URL, "_blank");
});

/* ===================== Init ===================== */
document.addEventListener("DOMContentLoaded", async ()=>{
  try{
    wireGetKeyButton();
    if(QUID && QPLACE){
      // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏ô server ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      await refreshFromStatus();
    }
  }catch(e){
    console.error(e);
  }
});
</script>
</body>
</html>
